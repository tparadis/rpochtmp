$(document).ready(function() {
	$.ajax({
		dataType: "json",
		contentType: "application/json",
		url: "http://rpoch.istic.univ-rennes1.fr/api/",
		data: {"req":"allcat","format":"json"},
		type: "GET",
		async: false,
		success: function(data) {
			for(var i = 0 ; i < data.sizecat ; i++) {
				var courantCat = data.cat[i];
				var listeSsCat = "listeSsCat"+i
				$("#navmenu").append("<div data-role='collapsible' class='categorie'><h3>"+courantCat.nom+"</h3><ul class='"+listeSsCat+"' data-role='listview' data-inset='true' data-icon='plus'></ul></div>");
				for(var j = 0 ; j < data.sizesscat ; j++) {
					var courantSsCat = data.sscat[j];
					if (courantSsCat.catparent == courantCat.id) {
						$("."+listeSsCat).append("<li><a href=\"<%= url_for :controller => :FinalParcours, :action => :final_parcours %>\" onclick=\"addSsCat('"+courantSsCat.nom+"')\">"+courantSsCat.nom+"</a></li>");
					}
				}
			}
		}
	});
});

/*$(document).ready(function() {
	$.ajax({
		dataType: "json",
		contentType: "application/json",
		url: "http://rpoch.istic.univ-rennes1.fr/api/",
		data: {"req":"cat","format":"json"},
		type: "GET",
		async: false,
		success: function(data) {
			var i = 0;
			while(i < data.size) {
				var courant = data.categories[i];
				tmp = $("#listeCat").append("<div data-role='collapsible' class='categorie'><h3>"+courant.nom+"</h3><ul data-role='listview' data-inset='true' data-icon='plus'>");
				suite(tmp, courant.id);
				i++;			
			}
		}
	});
});

function suite(idParent) {
	$.ajax({
		dataType: "json",
		contentType: "application/json",
		url: "http://rpoch.istic.univ-rennes1.fr/api/",
		data: {"req":"sscat","format":"json"},
		type: "GET",
		async: false,
		success: function(data) {
			var j = 0;
			while(j < data.size) {
				var courant = data.sscategories[j];
				if (courant.catparent == idParent) {
					tmp.append("<li><a href='<%= url_for :controller => :FinalParcours, :action => :final_parcours %>'>"+courant.nom+"</a></li>");
				}
				j++;
			}
			tmp.append("</ul></div>");			
		}
	});	
}*/

function setCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+d.toUTCString();
    document.cookie = cname + "=" + cvalue.toString() + "; " + expires;
}

function afficherTags(nomMagasin){
	document.write("je suis ici");
}

function addTags(){

}


function addSsCat(sscat) {
   	parcours.setItem(parcours.length, sscat);
}