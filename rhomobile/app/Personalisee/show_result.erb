<!DOCTYPE html>
<html>
<head>
  <style>
    #map {
      width: 390px;
      height: 530px;
    }
  </style>
  <script>

  var longitude1 = <%= get_resposnse()["commerces"][0]["vp_ne_lng"] %>;
  var latitude1 = <%= get_resposnse()["commerces"][0]["vp_ne_lat"] %> ;
  var longitude2 = <%= get_resposnse()["commerces"][1]["vp_ne_lng"] %>;
  var latitude2 = <%= get_resposnse()["commerces"][1]["vp_ne_lat"] %> ;
  var longitude3 = <%= get_resposnse()["commerces"][2]["vp_ne_lng"] %>;
  var latitude3 = <%= get_resposnse()["commerces"][2]["vp_ne_lat"] %> ;
  var longitude4 = <%= get_resposnse()["commerces"][3]["vp_ne_lng"] %>;
  var latitude4 = <%= get_resposnse()["commerces"][3]["vp_ne_lat"] %> ;
  var longitude5 = <%= get_resposnse()["commerces"][4]["vp_ne_lng"] %>;
  var latitude5 = <%= get_resposnse()["commerces"][4]["vp_ne_lat"] %> ;
  var longitude6 = <%= get_resposnse()["commerces"][5]["vp_ne_lng"] %>;
  var latitude6 = <%= get_resposnse()["commerces"][5]["vp_ne_lat"] %> ;
  var longitude7 = <%= get_resposnse()["commerces"][6]["vp_ne_lng"] %>;
  var latitude7 = <%= get_resposnse()["commerces"][6]["vp_ne_lat"] %> ;
  var longitude8 = <%= get_resposnse()["commerces"][7]["vp_ne_lng"] %>;
  var latitude8 = <%= get_resposnse()["commerces"][7]["vp_ne_lat"] %> ;
  var longitude9 = <%= get_resposnse()["commerces"][8]["vp_ne_lng"] %>; 
  var latitude9 = <%= get_resposnse()["commerces"][8]["vp_ne_lat"] %> ; 
  var longitude10 = <%= get_resposnse()["commerces"][9]["vp_ne_lng"] %>;
  var latitude10 = <%= get_resposnse()["commerces"][9]["vp_ne_lat"] %> ;
  var longitude11 = <%= get_resposnse()["commerces"][10]["vp_ne_lng"] %>;
  var latitude11 = <%= get_resposnse()["commerces"][10]["vp_ne_lat"] %> ;
  var longitude12 = <%= get_resposnse()["commerces"][11]["vp_ne_lng"] %>;
  var latitude12 = <%= get_resposnse()["commerces"][11]["vp_ne_lat"] %> ;
  var longitude13 = <%= get_resposnse()["commerces"][12]["vp_ne_lng"] %>;
  var latitude13 = <%= get_resposnse()["commerces"][12]["vp_ne_lat"] %> ;
  var longitude14 = <%= get_resposnse()["commerces"][13]["vp_ne_lng"] %>;
  var latitude14 = <%= get_resposnse()["commerces"][13]["vp_ne_lat"] %> ;
  var longitude15 = <%= get_resposnse()["commerces"][14]["vp_ne_lng"] %>;
  var latitude15 = <%= get_resposnse()["commerces"][14]["vp_ne_lat"] %> ;
  var longitude16 = <%= get_resposnse()["commerces"][15]["vp_ne_lng"] %>;
  var latitude16 = <%= get_resposnse()["commerces"][15]["vp_ne_lat"] %> ;
  var longitude17 = <%= get_resposnse()["commerces"][16]["vp_ne_lng"] %>;
  var latitude17 = <%= get_resposnse()["commerces"][16]["vp_ne_lat"] %> ;
  var longitude18 = <%= get_resposnse()["commerces"][17]["vp_ne_lng"] %>;
  var latitude18 = <%= get_resposnse()["commerces"][17]["vp_ne_lat"] %> ;
  var longitude19 = <%= get_resposnse()["commerces"][18]["vp_ne_lng"] %>;
  var latitude19 = <%= get_resposnse()["commerces"][18]["vp_ne_lat"] %> ;
  var longitude20 = <%= get_resposnse()["commerces"][19]["vp_ne_lng"] %>;
  var latitude20 = <%= get_resposnse()["commerces"][19]["vp_ne_lat"] %> ;
  var longitude21 = <%= get_resposnse()["commerces"][20]["vp_ne_lng"] %>;
  var latitude21 = <%= get_resposnse()["commerces"][20]["vp_ne_lat"] %> ;
    function initialize() {

      var directionsService = new google.maps.DirectionsService;
      var directionsDisplay = new google.maps.DirectionsRenderer;
      var mapCanvas = document.getElementById('map');
      var mapOptions = {
        center: new google.maps.LatLng(48.112739, -1.681489),
        zoom: 15,
        mapTypeId: google.maps.MapTypeId.ROADMAP
      }
      var map = new google.maps.Map(mapCanvas, mapOptions)
      

      
     
      directionsDisplay.setMap(map);
      
      var request = {
          origin:new google.maps.LatLng(latitude1, longitude1),
          destination:new google.maps.LatLng(latitude10, longitude10),
          optimizeWaypoints: true,
        waypoints: [
                      {
                        location:new google.maps.LatLng(latitude2, longitude2),
                        stopover:true
                      },
                      {
                        location:new google.maps.LatLng(latitude3, longitude3),
                        stopover:true
                      },
                      {
                        location:new google.maps.LatLng(latitude4, longitude4),
                        stopover:true
                      },
{
  location:new google.maps.LatLng(latitude5, longitude5),
  stopover:true
},
{
  location:new google.maps.LatLng(latitude6, longitude6),
  stopover:true
},
{
  location:new google.maps.LatLng(latitude7, longitude7),
  stopover:true
},
{
  location:new google.maps.LatLng(latitude8, longitude8),
  stopover:true
}
,
{
  location:new google.maps.LatLng(latitude9, longitude9),
  stopover:true
}
                      ],
          travelMode: google.maps.TravelMode.WALKING
        };
        directionsService.route(request, function(result, status) {
          if (status == google.maps.DirectionsStatus.OK) {
            directionsDisplay.setDirections(result);
          }
        });

    }

    
    </script>
</head>
<body>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAfh64T7GInE-G0rPQ35PHjmPr1erbaJgg&signed_in=true&callback=initialize"
  async defer></script>

  <div id="map"></div>
</body>
</html>